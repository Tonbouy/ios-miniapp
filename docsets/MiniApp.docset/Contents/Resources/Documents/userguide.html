<!DOCTYPE html>
<html lang="en">
  <head>
    <title>USERGUIDE  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>
    <a title="USERGUIDE  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">MiniApp 2.6.0 Docs</a> (59% documented)</p>
        <p class="header-right">
          <form role="search" action="search.json">
            <input type="text" placeholder="Search documentation" data-typeahead>
          </form>
        </p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">MiniApp Reference</a>
        <img id="carat" src="img/carat.png" />
        USERGUIDE  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="changelog.html">CHANGELOG</a>
              </li>
              <li class="nav-group-task">
                <a href="dev.html">DEV</a>
              </li>
              <li class="nav-group-task">
                <a href="readme.html">README</a>
              </li>
              <li class="nav-group-task">
                <a href="userguide.html">USERGUIDE</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/MASDKCustomPermissionModel.html">MASDKCustomPermissionModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MATokenInfo.html">MATokenInfo</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MiniApp.html">MiniApp</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MiniAppExternalUrlLoader.html">MiniAppExternalUrlLoader</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MiniAppNavigationConfig.html">MiniAppNavigationConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/MASDKCustomPermissionError.html">MASDKCustomPermissionError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MASDKPermissionError.html">MASDKPermissionError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MASDKPermissionResponse.html">MASDKPermissionResponse</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MASDKProtocolResponse.html">MASDKProtocolResponse</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MiniAppCustomPermissionGrantedStatus.html">MiniAppCustomPermissionGrantedStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MiniAppCustomPermissionType.html">MiniAppCustomPermissionType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MiniAppNavigationAction.html">MiniAppNavigationAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MiniAppNavigationVisibility.html">MiniAppNavigationVisibility</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MiniAppPermissionType.html">MiniAppPermissionType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/MiniAppDisplayDelegate.html">MiniAppDisplayDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MiniAppNavigationBarDelegate.html">MiniAppNavigationBarDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MiniAppNavigationDelegate.html">MiniAppNavigationDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MiniAppShareContentDelegate.html">MiniAppShareContentDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MiniAppUserInfoDelegate.html">MiniAppUserInfoDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/MiniAppInfo.html">MiniAppInfo</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MiniAppShareContent.html">MiniAppShareContent</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Version.html">Version</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:7MiniApp34MASDKDownloadedListPermissionsPaira">MASDKDownloadedListPermissionsPair</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:7MiniApp0aB15DisplayProtocola">MiniAppDisplayProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:7MiniApp0aB15MessageProtocola">MiniAppMessageProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:7MiniApp0aB25NavigationResponseHandlera">MiniAppNavigationResponseHandler</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='miniapp' class='heading'>MiniApp</h1>

<p>This open-source library allows you to integrate Mini App ecosystem into your iOS applications.
Mini App SDK also facilitates communication between a mini app and the host app via a message bridge.</p>
<h2 id='features' class='heading'>Features</h2>

<ul>
<li>Load MiniApp list</li>
<li>Load MiniApp metadata</li>
<li>Create a MiniApp view</li>
<li>Facilitate comm between host app and mini app</li>
</ul>

<p>All the MiniApp files downloaded by the MiniApp iOS library are cached locally</p>
<h2 id='getting-started' class='heading'>Getting started</h2>

<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="https://rakutentech.github.io/ios-miniapp/">Documentation</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#usage">Usage</a></li>
</ul>
<h2 id='requirements' class='heading'>Requirements</h2>

<p>This module supports <strong>iOS 11.0 and above</strong>. It has been tested on iOS 11.0 and above.</p>

<p>It is written in Swift 5.0 and can be used in compatible Xcode versions.</p>

<p>In order to run your MiniApp you will have to provide the following,</p>

<ul>
<li>MiniApp host application identifier (<code>RASProjectId</code>)</li>
<li>Subscription key (<code>RASProjectSubscriptionKey</code>)</li>
<li>Base URL for API requests to the library (<code>RMAAPIEndpoint</code>)</li>
<li>Preference, if you want to make use of Test API Endpoints in your application or not</li>
</ul>
<h2 id='installation' class='heading'>Installation</h2>

<p>Mini App SDK is available through <a href="https://cocoapods.org">CocoaPods</a>. To install it, simply add the following line to your Podfile:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'MiniApp'</span>
</code></pre>
<h2 id='configuration' class='heading'>Configuration</h2>

<p>In your project configuration .plist you should add below Key/Value :</p>

<table><thead>
<tr>
<th style="text-align: left">Key</th>
<th style="text-align: center">Type</th>
<th style="text-align: left">Description</th>
<th style="text-align: center">Optional</th>
<th style="text-align: center">Default</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">RASProjectId</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Set your MiniApp host application project identifier</code></td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RASProjectSubscriptionKey</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Set your MiniApp subscription key</code></td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RMAAPIEndpoint</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Provide your own Base URL for API requests</code></td>
<td style="text-align: center">NO</td>
<td style="text-align: center"><code>none</code></td>
</tr>
<tr>
<td style="text-align: left">RMAHostAppUserAgentInfo</td>
<td style="text-align: center">String</td>
<td style="text-align: left"><code>Host app name and version info that is appended in User agent. The value specified in the plist is retrieved only at the build time.</code></td>
<td style="text-align: center">YES</td>
<td style="text-align: center"><code>none</code></td>
</tr>
</tbody></table>

<p>If you don&rsquo;t want to use project settings, you have to pass this information one by one to the <code>Config.userDefaults</code> using a <code>Config.Key</code> as key:</p>
<pre class="highlight swift"><code><span class="kt">Config</span><span class="o">.</span><span class="n">userDefaults</span><span class="p">?</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="s">"MY_CUSTOM_ID"</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="kt">Key</span><span class="o">.</span><span class="n">subscriptionKey</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
</code></pre>

<div id="usage"></div>
<h2 id='usage' class='heading'>Usage</h2>

<ul>
<li><a href="#runtime-conf">Overriding configuration on runtime</a></li>
<li><a href="#load-miniapp-list">Load the Mini App list</a></li>
<li><a href="#get-mini-appinfo">Get a MiniAppInfo</a></li>
<li><a href="#create-mini-app">Create a MiniApp</a></li>
<li><a href="#MiniAppMessageDelegate">Communicate with MiniApp</a></li>
<li><a href="#navigation">Customize history navigation</a></li>
<li><a href="#custom-permissions">Custom Permissions</a></li>
<li><a href="#list-downloaded-mini-apps">List Downloaded Mini apps</a></li>
<li><a href="#user-profile-details">Retrieve User Profile details</a></li>
<li><a href="#orientation-lock">Orientation Lock</a></li>
<li><a href="#access-token-info">Access Token info</a></li>
</ul>

<div id="runtime-conf"></div>
<h3 id='overriding-configuration-on-runtime' class='heading'>Overriding configuration on runtime</h3>

<hr>

<p>Every call to the API can be done with default parameters retrieved from the project .plist configuration file, or by providing a <code><a href="Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a></code> object during the call. Here is a simple example class we use to create the configuration in samples below:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">Config</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="kd">func</span> <span class="nf">getCurrent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">MiniAppSdkConfig</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">MiniAppSdkConfig</span><span class="p">(</span><span class="nv">baseUrl</span><span class="p">:</span> <span class="s">"https://your.custom.url"</span>
                                <span class="nv">rasAppId</span><span class="p">:</span> <span class="s">"your_RAS_App_id"</span><span class="p">,</span>
                                <span class="nv">subscriptionKey</span><span class="p">:</span> <span class="s">"your_subscription_key"</span><span class="p">,</span>
                                <span class="nv">hostAppVersion</span><span class="p">:</span> <span class="s">"your_custom_version"</span><span class="p">,</span>
                                <span class="nv">isTestMode</span><span class="p">:</span> <span class="kc">true</span><span class="s">")
    }
}
</span></code></pre>

<p><em>NOTE:</em> <code>RMAHostAppUserAgentInfo</code> cannot be configured at run time.</p>

<div id="load-miniapp-list"></div>
<h3 id='load-the-code-miniapp-code-list' class='heading'>Load the <code><a href="Classes/MiniApp.html">MiniApp</a></code> list:</h3>

<hr>

<p>MiniApp library calls are done via the <code>MiniApp.shared()</code> singleton with or without a <code><a href="Classes/MiniAppSdkConfig.html">MiniAppSdkConfig</a></code> instance (you can get the current one with <code>Config.getCurrent()</code>). If you don&rsquo;t provide a config instance, values in custom iOS target properties will be used by default. </p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="n">list</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>or</p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">getCurrent</span><span class="p">())</span><span class="o">.</span><span class="n">list</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<div id="get-mini-appinfo"></div>
<h3 id='getting-a-code-miniappinfo-code' class='heading'>Getting a <code><a href="Structs/MiniAppInfo.html">MiniAppInfo</a></code> :</h3>

<hr>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppID</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>or</p>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">getCurrent</span><span class="p">())</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppID</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<div id="create-mini-app"></div>
<h3 id='create-a-miniapp-for-the-given-code-miniappid-code' class='heading'>Create a MiniApp for the given <code>MiniAppId</code> :</h3>

<hr>
<pre class="highlight swift"><code><span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">create</span><span class="p">(</span><span class="nv">appId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">miniAppDisplay</span><span class="p">):</span>
                <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">miniAppDisplay</span><span class="o">.</span><span class="nf">getMiniAppView</span><span class="p">()</span>
                <span class="n">view</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bounds</span>
                <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
            <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Error: "</span><span class="p">,</span> <span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span><span class="p">)</span>
            <span class="p">}</span>
<span class="p">},</span> <span class="nv">messageInterface</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>

</code></pre>

<div id="MiniAppMessageDelegate"></div>
<h3 id='implement-the-miniappmessagedelegate-in-your-view-controller' class='heading'>Implement the MiniAppMessageDelegate in your View Controller</h3>

<hr>

<p>The <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code> is used for passing messages between the Mini App (JavaScript) and the Host App (your native iOS App) and vice versa. Your App must provide the implementation for these functions.</p>

<p><code>NOTE: Following code snippets is an example for implementing MiniAppMessageDelegate methods, you can add your own custom implementation or you can make use of the code which is provided in the Sample app.</code></p>
<h5 id='retrieving-unique-id' class='heading'>Retrieving Unique ID</h5>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getUniqueId</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">deviceId</span> <span class="o">=</span> <span class="kt">UIDevice</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">identifierForVendor</span><span class="p">?</span><span class="o">.</span><span class="n">uuidString</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">""</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">deviceId</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h5 id='requesting-location-permissions' class='heading'>Requesting Location Permissions</h5>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">requestPermission</span><span class="p">(</span><span class="nv">permissionType</span><span class="p">:</span> <span class="kt">MiniAppPermissionType</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">permissionType</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">location</span><span class="p">:</span>
            <span class="k">let</span> <span class="nv">locStatus</span> <span class="o">=</span> <span class="kt">CLLocationManager</span><span class="o">.</span><span class="nf">authorizationStatus</span><span class="p">()</span>
            <span class="k">switch</span> <span class="n">locStatus</span> <span class="p">{</span>
            <span class="k">case</span> <span class="o">.</span><span class="n">authorizedAlways</span><span class="p">,</span> <span class="o">.</span><span class="nv">authorizedWhenInUse</span><span class="p">:</span>
                <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">"allowed"</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>

<div id="request-custom-permission"></div>
<h5 id='requesting-custom-permissions' class='heading'>Requesting Custom Permissions</h5>

<p>SDK has its own implementation to show the list of requested custom permissions. If you want to display your own UI for requesting custom permissions, you can do it by overriding the method like below,</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
        <span class="kd">func</span> <span class="nf">requestCustomPermissions</span><span class="p">(</span>
            <span class="nv">permissions</span><span class="p">:</span> <span class="p">[</span><span class="kt">MASDKCustomPermissionModel</span><span class="p">],</span>
            <span class="nv">miniAppTitle</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
            <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span>
            <span class="kt">Result</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">MASDKCustomPermissionModel</span><span class="p">],</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="n">permissions</span><span class="p">))</span>    
            <span class="p">}</span>

</code></pre>

<div id="share-mini-app-content"></div>
<h5 id='share-mini-app-content' class='heading'>Share Mini app content</h5>

<p>By default, Mini App iOS SDK can open its own controller for content sharing. If you want to override this, you just have to implement the <code>shareContent(info: MiniAppShareContent, completionHandler: @escaping (Result&lt;MASDKProtocolResponse, Error&gt;) -&gt; Void)</code> from <code><a href="Protocols/MiniAppShareContentDelegate.html">MiniAppShareContentDelegate</a></code>, which is part of <code><a href="Protocols/MiniAppMessageDelegate.html">MiniAppMessageDelegate</a></code>.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">shareContent</span><span class="p">(</span><span class="nv">info</span><span class="p">:</span> <span class="kt">MiniAppShareContent</span><span class="p">,</span>
            <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span>
                <span class="kt">Result</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">activityController</span> <span class="o">=</span> <span class="kt">UIActivityViewController</span><span class="p">(</span><span class="nv">activityItems</span><span class="p">:</span> <span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">messageContent</span><span class="p">],</span> <span class="nv">applicationActivities</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="nf">present</span><span class="p">(</span><span class="n">activityController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="s">"SUCCESS"</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<div id="navigation"></div>
<h3 id='add-a-web-navigation-interface-to-the-miniapp-view' class='heading'>Add a web navigation interface to the MiniApp view</h3>

<hr>

<p>MiniApp iOS SDK provides a fully customizable way to implement a navigation interface inside your html pages with a <code><a href="Classes/MiniAppNavigationConfig.html">MiniAppNavigationConfig</a></code> object. The class takes 3 arguments:</p>

<ul>
<li><code>navigationBarVisibility</code> : 

<ul>
<li>never = the UI will never be shown</li>
<li>auto = navigation UI is only shown when a back or forward action is available</li>
<li>always = navigation UI is always present</li>
</ul></li>
<li><code>navigationDelegate</code> : A delegate that will receive MiniApp view instructions about available navigation options. It will also receive taps on external links.</li>
<li><code>customNavigationView</code> : A view implementing <code><a href="Protocols/MiniAppNavigationDelegate.html">MiniAppNavigationDelegate</a></code> that will be overlayed to the bottom of the MiniApp view</li>
</ul>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">navConfig</span> <span class="o">=</span> <span class="kt">MiniAppNavigationConfig</span><span class="p">(</span>
                    <span class="nv">navigationBarVisibility</span><span class="p">:</span> <span class="o">.</span><span class="n">always</span><span class="p">,</span>
                    <span class="nv">navigationDelegate</span><span class="p">:</span> <span class="n">myNavigationDelegate</span><span class="p">,</span>
                    <span class="nv">customNavigationView</span><span class="p">:</span> <span class="n">mCustomView</span><span class="p">)</span>

<span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="kt">Config</span><span class="o">.</span><span class="nf">getCurrent</span><span class="p">(),</span> <span class="nv">navigationSettings</span><span class="p">:</span> <span class="n">navConfig</span><span class="p">)</span><span class="o">.</span><span class="nf">info</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="n">miniAppID</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">in</span>
<span class="o">...</span>
<span class="p">}</span>
</code></pre>
<h4 id='opening-external-links' class='heading'>Opening external links</h4>

<p>By default MiniApp iOS SDK will open external links into a separate modal controller when tapped. <code><a href="Protocols/MiniAppNavigationDelegate.html">MiniAppNavigationDelegate</a></code> implements a method that allows to override this behaviour and provide your own external links management. Here is an example of implementation:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppNavigationDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">miniAppNavigation</span><span class="p">(</span><span class="n">shouldOpen</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span><span class="p">,</span> <span class="n">with</span> <span class="nv">externalLinkResponseHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">URL</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Getting your custom viewcontroller</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">UIStoryboard</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"Main"</span><span class="p">,</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span><span class="o">.</span><span class="nf">instantiateViewController</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"ExternalWebviewController"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">ExternalWebViewController</span> <span class="p">{</span>
            <span class="n">viewController</span><span class="o">.</span><span class="n">currentURL</span> <span class="o">=</span> <span class="n">url</span>
            <span class="n">viewController</span><span class="o">.</span><span class="n">miniAppExternalUrlLoader</span> <span class="o">=</span> <span class="kt">MiniAppExternalUrlLoader</span><span class="p">(</span><span class="nv">webViewController</span><span class="p">:</span> <span class="n">viewController</span><span class="p">,</span> <span class="nv">responseHandler</span><span class="p">:</span> <span class="n">externalLinkResponseHandler</span><span class="p">)</span>
            <span class="k">self</span><span class="o">.</span><span class="n">presentedViewController</span><span class="p">?</span><span class="o">.</span><span class="nf">present</span><span class="p">(</span><span class="n">viewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="o">...</span>
<span class="p">}</span>
</code></pre>

<p>The <code>externalLinkResponseHandler</code> closure allows you to give a feedback as an URL to the SDK, for example when the controller is closed or when a custom scheme link is tapped. This closure can be passed to a <code><a href="Classes/MiniAppExternalUrlLoader.html">MiniAppExternalUrlLoader</a></code> object that will provide a method to test an URL and return the appropriate decision for a <code>WKNavigationDelegate</code> method, and if you provided a controller it will be dismissed automatically. Here is an example following previous example:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ExternalWebViewController</span><span class="p">:</span> <span class="kt">WKNavigationDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">webView</span><span class="p">(</span><span class="n">_</span> <span class="nv">webView</span><span class="p">:</span> <span class="kt">WKWebView</span><span class="p">,</span> <span class="n">didFinish</span> <span class="nv">navigation</span><span class="p">:</span> <span class="kt">WKNavigation</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">currentURL</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">webView</span><span class="o">.</span><span class="n">url</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">webView</span><span class="p">(</span><span class="n">_</span> <span class="nv">webView</span><span class="p">:</span> <span class="kt">WKWebView</span><span class="p">,</span> <span class="n">decidePolicyFor</span> <span class="nv">navigationAction</span><span class="p">:</span> <span class="kt">WKNavigationAction</span><span class="p">,</span> <span class="nv">decisionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">WKNavigationActionPolicy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">decisionHandler</span><span class="p">(</span><span class="n">miniAppExternalUrlLoader</span><span class="p">?</span><span class="o">.</span><span class="nf">shouldOverrideURLLoading</span><span class="p">(</span><span class="n">navigationAction</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span> <span class="p">??</span> <span class="o">.</span><span class="n">allow</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<div id="custom-permissions"></div>
<h3 id='custom-permissions' class='heading'>Custom Permissions</h3>

<hr>

<p>MiniApp iOS SDK supports list of Custom Permissions ( <code><a href="Enums/MiniAppCustomPermissionType.html">MiniAppCustomPermissionType</a></code>) and these can be stored and retrieved using the following public interfaces.</p>
<h4 id='retrieving-the-mini-app-custom-permissions-using-miniappid' class='heading'>Retrieving the Mini App Custom Permissions using MiniAppID</h4>

<p>Custom permissions and its status can be retrieved using the following interface. <code>getCustomPermissions</code> will return list  of <code><a href="Classes/MASDKCustomPermissionModel.html">MASDKCustomPermissionModel</a></code> that contains the meta-info such as title and its granted status.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">miniAppPermissionsList</span> <span class="o">=</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">getCustomPermissions</span><span class="p">(</span><span class="nv">forMiniApp</span><span class="p">:</span> <span class="n">miniAppId</span><span class="p">)</span>
</code></pre>
<h4 id='store-the-mini-app-custom-permissions' class='heading'>Store the Mini App Custom Permissions</h4>

<p>Custom permissions for a mini app is cached by the SDK and you can use the following interface to store and retrieve it when you need.</p>
<pre class="highlight swift"><code> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">setCustomPermissions</span><span class="p">(</span><span class="nv">forMiniApp</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">permissionList</span><span class="p">:</span> <span class="p">[</span><span class="kt">MASDKCustomPermissionModel</span><span class="p">])</span>
</code></pre>

<div id="list-downloaded-mini-apps"></div>
<h3 id='list-downloaded-mini-apps' class='heading'>List Downloaded Mini apps</h3>

<p>Gets the list of downloaded Mini apps info and associated custom permissions status</p>
<pre class="highlight swift"><code> <span class="kt">MiniApp</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span><span class="o">.</span><span class="nf">listDownloadedWithCustomPermissions</span><span class="p">()</span>
</code></pre>

<div id="user-profile-details"></div>
<h3 id='retrieve-user-profile-details' class='heading'>Retrieve User Profile details</h3>

<hr>

<p>Get the User profile related details using &lsquo;MiniAppMessageDelegate&rsquo;.
The following delegates/interfaces will be called only if the user has allowed respective <a href="#custom-permissions">Custom permissions</a></p>

<div id="user-profile-details-username"></div>
<h4 id='user-name' class='heading'>User Name</h4>

<p>Retrieve user name of the User</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getUserName</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the User name</span>
        <span class="k">return</span> <span class="s">""</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<div id="user-profile-details-profilephoto"></div>
<h4 id='profile-photo' class='heading'>Profile Photo</h4>

<p>Retrieve Profile Photo of the User</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getProfilePhoto</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">String</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// Implementation to return the Profile photo URI</span>
        <span class="k">return</span> <span class="s">""</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<div id="access-token-info"></div>
<h4 id='access-token-info' class='heading'>Access Token Info</h4>

<p>Retrieve access token and expiry date</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">MiniAppMessageDelegate</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">getAccessToken</span><span class="p">(</span><span class="nv">miniAppId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">Result</span><span class="o">&lt;</span><span class="kt">MATokenInfo</span><span class="p">,</span> <span class="kt">MASDKCustomPermissionError</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>

        <span class="nf">completionHandler</span><span class="p">(</span><span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">accessToken</span><span class="p">:</span> <span class="s">"ACCESS_TOKEN"</span><span class="p">,</span> <span class="nv">expirationDate</span><span class="p">:</span> <span class="kt">Date</span><span class="p">())))</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<div id="orientation-lock"></div>
<h3 id='orientation-lock' class='heading'>Orientation Lock</h3>

<hr>

<p>You can choose to give orientation lock control to mini apps. However, this requires you to add some code to your <code>AppDelegate</code> which could have an affect on your entire App. If you do not wish to do this, please see the section <em>&ldquo;Allow only full screen videos to change orientation&rdquo;.</em></p>
<h3 id='allow-mini-apps-to-lock-the-view-to-any-orientation' class='heading'>Allow mini apps to lock the view to any orientation</h3>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">supportedInterfaceOrientationsFor</span> <span class="nv">window</span><span class="p">:</span> <span class="kt">UIWindow</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">UIInterfaceOrientationMask</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kd">#available(iOS 12, *)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">window</span><span class="p">?</span><span class="o">.</span><span class="n">isKeyWindow</span> <span class="o">!=</span> <span class="kc">true</span> <span class="p">{</span>
                <span class="k">return</span> <span class="o">.</span><span class="n">all</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">.</span><span class="n">all</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
<h3 id='allow-full-screen-videos-to-change-orientation' class='heading'>Allow full screen videos to change orientation</h3>

<p>You can add the following if you want to enable videos to change orientation. Note that if you do not wish to add code to <code>AppDelegate</code> as in the above example, you can still allow videos inside the mini app to use landscape mode even when your App is locked to portrait mode and vice versa.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">AVKit</span>

<span class="kd">extension</span> <span class="kt">AVPlayerViewController</span> <span class="p">{</span>
    <span class="kd">open</span> <span class="k">override</span> <span class="k">var</span> <span class="nv">supportedInterfaceOrientations</span><span class="p">:</span> <span class="kt">UIInterfaceOrientationMask</span> <span class="p">{</span>
        <span class="k">if</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">.</span><span class="n">all</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">MiniApp</span><span class="o">.</span><span class="kt">MAOrientationLock</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<div id="change-log"></div>
<h2 id='changelog' class='heading'>Changelog</h2>

<p>See the full <a href="https://github.com/rakutentech/ios-miniapp/blob/master/CHANGELOG.md">CHANGELOG</a>.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://github.com/rakutentech/ios-miniapp" target="_blank" rel="external">Rakuten Ecosystem Mobile</a>. All rights reserved. (Last updated: 2020-11-27)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
